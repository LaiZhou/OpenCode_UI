<!-- Plugin Configuration File: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
  <id>ai.opencode.ide.jetbrains</id>
  <name>OpenCode UI</name>
  <vendor email="hhlai1990@gmail.com" url="https://github.com/LaiZhou/OpenCode_UI">laizhou</vendor>
  

  <description><![CDATA[
    <b>OpenCode UI - AI Coding Agent for JetBrains IDEs</b><br><br>
    
    Seamlessly integrates <a href="https://opencode.ai">OpenCode</a> directly into your workflow.<br><br>
    
    <b>Key Features:</b><br>
    <ul>
        <li><b>Quick Launch:</b> Connect to existing OpenCode server (e.g., OpenCode Desktop) or create new terminal with <code>Cmd+Esc</code> / <code>Ctrl+Esc</code>. Supports automatic authentication.</li>
        <li><b>Context Sharing:</b> Send current file, selection, or Project View items to the agent with <code>Opt+Cmd+K</code> / <code>Ctrl+Alt+K</code>.</li>
        <li><b>Native Diff Review:</b> Review AI-generated changes in a multi-file diff viewer. Accept stages changes (<code>git add</code>), Reject restores original content. Automatic snapshots ensure you can always recover previous versions.</li>
    </ul>
  ]]></description>

  <depends>com.intellij.modules.platform</depends>
  <depends>org.jetbrains.plugins.terminal</depends>

  <actions>
    <action id="OpenCode.QuickLaunch"
            class="ai.opencode.ide.jetbrains.QuickLaunchAction"
            text="Open OpenCode"
            description="Open or focus the OpenCode terminal"
            icon="/icons/opencode.svg">
      <add-to-group group-id="ToolsMenu" anchor="first"/>
      <keyboard-shortcut keymap="$default" first-keystroke="control ESCAPE"/>
      <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta ESCAPE"/>
      <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta ESCAPE"/>
    </action>

    <action id="OpenCode.AddLines"
            class="ai.opencode.ide.jetbrains.SendSelectionToTerminalAction"
            text="Add lines to OpenCode Terminal"
            icon="/icons/opencode.svg">
      <add-to-group group-id="EditorPopupMenu" anchor="last"/>
      <keyboard-shortcut keymap="$default" first-keystroke="control alt K"/>
      <keyboard-shortcut keymap="Mac OS X" first-keystroke="alt meta K"/>
      <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="alt meta K"/>
    </action>

    <action id="OpenCode.AddFile"
            class="ai.opencode.ide.jetbrains.SendSelectionToTerminalAction"
            text="Add to OpenCode Terminal"
            icon="/icons/opencode.svg">
      <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
      <keyboard-shortcut keymap="$default" first-keystroke="control alt K"/>
      <keyboard-shortcut keymap="Mac OS X" first-keystroke="alt meta K"/>
      <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="alt meta K"/>
    </action>
  </actions>

  <extensions defaultExtensionNs="com.intellij">
    <!-- Project-level Services -->
    <projectService serviceImplementation="ai.opencode.ide.jetbrains.OpenCodeService"/>
    <projectService serviceImplementation="ai.opencode.ide.jetbrains.session.SessionManager"/>
    <projectService serviceImplementation="ai.opencode.ide.jetbrains.diff.DiffViewerService"/>

    <!-- File Editor Provider -->
    <fileEditorProvider implementation="ai.opencode.ide.jetbrains.terminal.OpenCodeTerminalFileEditorProvider"/>

    <!-- Notifications -->
    <notificationGroup id="OpenCode" displayType="BALLOON"/>

    <toolWindow id="OpenCode"
                factoryClass="ai.opencode.ide.jetbrains.OpenCodeToolWindowFactory"
                icon="/icons/opencode.svg"
                anchor="right"/>

  </extensions>
</idea-plugin>
